# 模型置信度说明

## 什么是置信度？

置信度是对模型预测能力进行综合评估的量化指标（0-100分），帮助您了解模型在不同市场环境下的表现。

## 置信度评分构成

置信度由以下四个维度加权计算得出：

### 1. 方向准确率（权重：40%）⭐最重要
**定义**：模型正确预测价格涨跌方向的比例

**评分标准**：
- 优秀：≥65%（铜价预测中已属优秀水平）
- 良好：55%-65%
- 较差：<55%

**示例**：
```
方向准确率 = 正确预测涨跌次数 / 总预测次数
例如：预测10次，7次正确 = 70%（优秀）
```

**为什么最重要？**
- 交易中最关心的是"涨还是跌"，而非精确的价格
- 方向准确率高意味着能抓住趋势，避免反向交易
- 实证研究表明，方向准确率达到65%即可实现盈利

### 2. R²解释力（权重：30%）
**定义**：模型能解释的价格变动比例

**评分标准**：
- 强：>0.6（解释力强）
- 一般：0.3-0.6
- 弱：<0.3

**重要提示**：
⚠️ **R² > 0.6仅说明解释力强，不保证预测力！**

R²高意味着模型能很好地拟合历史数据，但：
- 可能存在过拟合
- 可能无法适应新的市场环境
- 不代表对未来预测准确

### 3. 归一化RMSE（权重：20%）
**定义**：预测误差相对于价格水平的比例

**评分标准**：
- 精确：<3%
- 良好：3%-5%
- 一般：>5%

**计算公式**：
```
归一化RMSE = RMSE / 平均价格 × 100%
例如：RMSE=3000元，平均价格=100000元 = 3%（良好）
```

### 4. 误差稳定性（权重：10%）
**定义**：预测误差的波动程度（变异系数）

**评分标准**：
- 稳定：CV<0.2
- 一般：CV 0.2-0.3
- 不稳定：CV>0.3

## 综合置信度评分

### 高置信度（80-100分）
**特征**：
- 方向准确率≥65%
- R²>0.6
- 归一化RMSE<3%

**使用建议**：
✅ 可以参考其预测方向
✅ 建议仓位：5%-10%
✅ 仍需设置止损（铜价单日波动可达5%）

**示例场景**：
- 模型在趋势市和震荡市都表现良好
- 方向准确率70%，R²0.85
- 置信度评分：85/100

### 中置信度（60-79分）
**特征**：
- 方向准确率55%-65%
- R² 0.3-0.6
- 归一化RMSE 3%-5%

**使用建议**：
⚠️ 需谨慎使用，结合其他指标
⚠️ 建议仓位：2%-5%
⚠️ 必须严格执行止损

**示例场景**：
- 模型在趋势市表现好，震荡市表现一般
- 方向准确率60%，R²0.5
- 置信度评分：68/100

### 低置信度（<60分）
**特征**：
- 方向准确率<55%
- R²<0.3
- 归一化RMSE>5%

**使用建议**：
❌ 不建议直接使用
❌ 建议仓位：0%-2%
❌ 需要重新训练或优化模型

**示例场景**：
- 模型过拟合历史数据
- 方向准确率45%，R²0.2
- 置信度评分：42/100

## 置信度与其他指标的关系

### 与R²的关系
```
高R²（>0.6）  ≠ 高置信度

示例：
模型A：R²=0.85，方向准确率=50% → 置信度中等
模型B：R²=0.6，方向准确率=70% → 置信度高 ✅
```

### 与压力测试的关系
```
置信度高  ≠ 抵抗极端风险

即使置信度评分90，仍可能受到：
- 中国需求断崖：价格可能下跌21%
- 美元流动性危机：价格可能下跌5-30%
- 供应端黑天鹅：价格可能上涨4-14%

因此必须：
✅ 设置止损（建议3%）
✅ 控制仓位（建议≤10%）
✅ 分批建仓
```

## 如何在网页上使用

### 启用模型验证
在网页上勾选"🔍 运行模型验证（推荐）"选项，系统会：
1. 训练选定的模型
2. 运行滚动窗口回测（Walk-forward Analysis）
3. 执行压力测试（3种极端情景）
4. 计算置信度评分
5. 生成风险管理报告

### 查看结果
完成后，网页会显示：
- 置信度评分（0-100分）
- 置信度等级（高/中/低）
- 各维度得分详情
- 风险管理建议

### 下载验证报告
详细报告保存在：`validation_report_{model_type}_{timestamp}.txt`

报告包含：
- 方向准确率详细分析
- R²解释力说明
- 压力测试结果
- 风险等级评估
- 具体的止损止盈建议

## 实用建议

### 1. 不要迷信高置信度
- 置信度是基于历史数据的评估
- 市场环境变化时，置信度可能失效
- 铜价单日波动可达5%，必须设置止损

### 2. 关注方向准确率
- 方向准确率≥65%已属优秀
- 比R²更重要
- 决定交易能否盈利

### 3. 结合压力测试
- 了解模型在极端情况下的表现
- 最坏情况可能损失21%
- 根据压力测试结果调整仓位

### 4. 动态调整策略
```
高置信度 + 趋势市 → 可适当增加仓位（8%-10%）
中置信度 + 震荡市 → 降低仓位（2%-5%）
低置信度 → 暂时观望，或仓位≤2%
```

### 5. 多模型组合
不要依赖单一模型：
- 技术模型（XGBoost）：短期交易信号
- 宏观模型（ARDL）：中期趋势判断
- 基本面模型（VAR）：长期方向把握

多模型一致时，置信度更高。

## 常见问题

### Q1: 置信度85分，可以满仓吗？
A: ❌ 不可以。即使置信度85分：
- 铜价单日波动可达5%
- 压力测试显示可能损失21%
- 建议最大仓位10%，必须设置3%止损

### Q2: R²高但置信度低，为什么？
A: 可能原因：
- 方向准确率低（R²高但涨跌判断不准）
- 误差不稳定（预测忽高忽低）
- 过拟合（拟合历史但不适应新数据）

**方向准确率权重40%**，这是最重要的指标。

### Q3: 置信度会变化吗？
A: 会。建议：
- 每月重新验证一次
- 市场环境突变时及时验证
- 多个时间周期综合评估

### Q4: 如何提高置信度？
A: 可以尝试：
- 增加训练数据量
- 优化特征工程
- 调整模型参数
- 使用多模型集成
- 区分不同市场环境训练

## 示例：解读置信度报告

```
============================================================
🚨 风险管理报告
============================================================

【模型置信度】
  R² (解释力): 0.8765
  方向准确率: 67.78%
    ✓ 优秀: 方向准确率达到优秀标准(≥65%)

【压力测试】
  最坏情景: 综合最坏情景
  潜在最大损失: 21.00%
    🚨 极高风险: 必须严格控制仓位

【风险管理建议】
  1. 单日最大止损: 3.0%
     (铜价单日波动可达5%,必须设置止损)
  2. 目标止盈: 5.0%
  3. 建议最大仓位: 10% (根据模型置信度调整)
  4. 分批建仓,分散风险
```

**解读**：
1. **方向准确率67.78%** - 优秀✅
   - 能正确判断7次涨跌中的5次
   - 可以参考其方向预测

2. **R² 0.8765** - 解释力强
   - 能解释87.65%的价格变动
   - 但不保证预测力，需结合方向准确率

3. **压力测试-21%** - 极高风险⚠️
   - 中国需求断崖可能导致价格下跌21%
   - 必须设置止损，控制仓位

4. **风险管理建议** - 执行它！
   - 止损3%，止盈5%
   - 最大仓位10%
   - 分批建仓，降低风险

## 总结

✅ **置信度是参考，不是绝对**
✅ **方向准确率最重要，≥65%为优秀**
✅ **R²高不代表预测力强**
✅ **铜价波动大，必须设置止损**
✅ **压力测试显示最坏损失21%，控制仓位**
✅ **多模型组合，动态调整策略**

记住：模型辅助决策，风险自己承担！
