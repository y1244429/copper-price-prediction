# 铜价预测系统 - 多模型版本

## 系统概述

铜价预测系统现已升级为多模型版本，提供三种不同时间维度的预测能力：

1. **技术分析模型**（原有）- 短期交易（天/周级别）
2. **宏观因子模型**（新增）- 中期波动（1-6个月）
3. **基本面模型**（新增）- 长期趋势（6个月以上）

---

## 1. 基本面模型（长期趋势）

### 适用场景
- 6个月以上战略配置
- 长期投资决策
- 产业布局规划

### 核心变量

#### 1.1 供需平衡表
- **全球精铜产量**（ICSG数据）
  - 主要产铜国：智利、秘鲁、中国、刚果
  - 产量增长率变化
  
- **中国表观消费量**
  - 表观消费量 = 产量 + 进口量 - 出口量
  - 反映全球最大铜消费国需求

- **显性库存变化率**
  - LME库存
  - SHFE库存
  - COMEX库存
  - 库存与价格呈负相关关系

#### 1.2 成本曲线支撑
- **C1成本（现金成本）90分位线**
  - 高成本矿山停产位置
  - 价格底部支撑
  
- **完全成本75分位线**
  - 包含资本成本的长期支撑
  - 新项目投资门槛

#### 1.3 矿山干扰率
- **智利干扰指数**
  - 罢工风险
  - 品位下滑
  - 政策变化

- **秘鲁干扰指数**
  - 社区抗议
  - 环境政策

### 建模方法
- **向量自回归（VAR）** - 捕捉多变量动态关系
- **结构方程模型（SEM）** - 分析因果路径
- **RandomForest备选** - VAR失败时的容错方案

### 预测特点
- 预测周期：180天（6个月）
- 信心水平：高
- 核心逻辑：供需平衡决定长期趋势，成本曲线提供底部支撑

---

## 2. 宏观因子模型（中期波动）

### 适用场景
- 1-6个月战术调整
- 周期性交易机会
- 宏观政策响应

### 核心变量

#### 2.1 美元指数
- **负相关性极强**（系数通常-0.7以上）
- 铜以美元计价
- 美元走强 → 铜价承压
- 关键指标：
  - 美元指数变化率
  - 美元强度（相对MA20）
  - 5日/20日移动平均

#### 2.2 中国PMI/信贷脉冲
- **铜被称为"铜博士"**
- 对全球制造业景气度极度敏感
- 关键指标：
  - 中国制造业PMI
  - PMI变化趋势
  - PMI景气度分类（>50为扩张）
  - 信贷脉冲（M2增速）

#### 2.3 实际利率
- **10Y TIPS收益率**反映持有机会成本
- 利率上升 → 持有成本上升 → 价格承压
- 关键指标：
  - TIPS收益率
  - 利率变化方向
  - 利率环境分类

#### 2.4 期限结构
- **LME升贴水**（Contango/Backwardation）
- 反映即期供需紧张度
- 关键指标：
  - 现货与3月期货价差
  - 升贴水强度
  - 期限结构变化

### 建模方法
- **ARDL（自回归分布滞后模型）** - 捕捉动态调整过程
- **动态因子模型（DFM）** - 降维提取共同因子
- **ElasticNet + RandomForest备选** - 正则化防止过拟合

### 预测特点
- 预测周期：90天（3个月）
- 信心水平：中
- 核心逻辑：宏观因子驱动中期波动，美元与PMI是关键

---

## 3. 技术分析模型（原有）

### 适用场景
- 短期交易（天/周级别）
- 高频交易
- 技术面分析

### 核心变量
- 39个技术指标
- 价格动量
- 波动率
- 成交量特征
- 趋势指标

### 建模方法
- **XGBoost** - 梯度提升树
- 深度学习备选（LSTM）

### 预测特点
- 预测周期：5-30天
- 信心水平：中高
- 核心逻辑：技术指标反映短期价格动量

---

## 使用方法

### 命令行使用

```bash
# 运行完整演示（所有模型）
python main.py --demo

# 仅训练特定模型
python main.py --train-xgb      # 训练XGBoost模型
python main.py --train-macro    # 训练宏观因子模型
python main.py --train-fundamental  # 训练基本面模型

# 生成预测
python main.py --predict

# 生成报告
python main.py --report
```

### Python API使用

```python
from main import CopperPredictionSystem

# 初始化系统
system = CopperPredictionSystem(data_source='auto')

# 加载数据
system.load_data(days=365)

# 训练模型
system.train_xgboost()
system.train_macro()
system.train_fundamental()

# 生成预测
short_pred = system.predict(horizon=5)
macro_pred = system.macro_model.predict(system.current_data, horizon=90)
fundamental_pred = system.fundamental_model.predict(system.current_data, horizon=180)

# 生成报告
system.generate_report()
```

---

## 多模型综合分析

### 预测对比

| 模型类型 | 预测周期 | 当前价格 | 预测价格 | 预测收益 | 信心水平 |
|---------|----------|----------|----------|----------|----------|
| 技术分析（5天） | 5天 | ¥103,920 | ¥106,440 | +2.42% | 中高 |
| 技术分析（30天） | 30天 | ¥103,920 | ¥106,440 | +2.42% | 中高 |
| 宏观因子 | 90天 | ¥103,920 | ¥107,086 | +3.05% | 中 |
| 基本面 | 180天 | ¥103,920 | ¥104,595 | +0.65% | 高 |

### 投资建议

- **短期（5天）**：看涨 | 技术面显示上涨动能
- **中期（1-6个月）**：看涨 | 宏观因子支撑上涨
- **长期（6个月+）**：看涨 | 基本面供需平衡改善

---

## 报告输出

系统自动生成三种格式的报告：

1. **文本报告**（.txt）
   - 完整的分析结论
   - 所有模型的预测结果
   - 投资建议

2. **HTML报告**（.html）
   - 可视化展示
   - 交互式图表
   - 适合网页展示

3. **PPT报告**（.pptx）
   - 专业演示文稿
   - 适合汇报展示
   - 包含关键图表

---

## 技术实现

### 依赖库

```txt
pandas>=1.5.0
numpy>=1.23.0
xgboost>=1.7.0
scikit-learn>=1.2.0
statsmodels>=0.13.0
akshare>=1.10.0
python-pptx>=0.6.0
```

### 数据源

- **AKShare** - 真实期货数据
- **MockDataSource** - 模拟数据（测试用）

---

## 风险提示

1. **模型局限性**
   - 历史数据无法预测黑天鹅事件
   - 基本面变化需要时间反映
   - 宏观政策转向难以捕捉

2. **数据质量**
   - 模拟数据与真实数据存在差异
   - 部分宏观数据更新频率较低

3. **投资建议**
   - 本报告仅供参考，不构成投资建议
   - 投资有风险，入市需谨慎
   - 建议结合其他分析工具综合判断

---

## 更新日志

### v2.1 (2026-02-28)
- ✅ 新增宏观因子模型（中期波动）
- ✅ 新增基本面模型（长期趋势）
- ✅ 支持多模型综合预测
- ✅ 优化报告格式
- ✅ 改进模型容错能力

### v2.0 (2026-02-27)
- 基础XGBoost模型
- Web界面支持
- 多格式报告输出

---

## 联系方式

如有问题或建议，请通过以下方式联系：
- 项目地址：/copper_prediction_v2
- 测试脚本：test_advanced_models.py
- 主程序：main.py

---

**© 2026 铜价预测系统 | Powered by AI**
